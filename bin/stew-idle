#!/bin/bash

# Idle management for hypridle

set -euo pipefail

is_enabled() {
    pgrep -x hypridle >/dev/null
}

toggle() {
    if is_enabled; then
        pkill hypridle
        notify-send -u normal "Caffeine Mode" "Idle management disabled - staying awake" -i preferences-system-power
    else
        hypridle &
        notify-send -u normal "Idle Management" "Idle management enabled" -i preferences-system-power
    fi
}

case "${1:-status}" in
    toggle)
        toggle
        ;;
    status)
        is_enabled && echo "enabled" || echo "disabled"
        ;;
    *)
        echo "Usage: $0 [toggle|status]" >&2
        exit 1
        ;;
esac
